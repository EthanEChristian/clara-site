<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>clara.tools.inspect documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clara-rules</span> <span class="project-version">0.9.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clara</span></div></div></li><li class="depth-2"><a href="clara.rules.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rules</span></div></a></li><li class="depth-3 branch"><a href="clara.rules.accumulators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>accumulators</span></div></a></li><li class="depth-3 branch"><a href="clara.rules.dsl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dsl</span></div></a></li><li class="depth-3 branch"><a href="clara.rules.durability.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>durability</span></div></a></li><li class="depth-3"><a href="clara.rules.listener.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>listener</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>tools</span></div></div></li><li class="depth-3 branch current"><a href="clara.tools.inspect.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inspect</span></div></a></li><li class="depth-3"><a href="clara.tools.tracing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tracing</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clara.tools.inspect.html#var--.3EExplanation"><div class="inner"><span>-&gt;Explanation</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-explain-activations"><div class="inner"><span>explain-activations</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-inspect"><div class="inner"><span>inspect</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-InspectionSchema"><div class="inner"><span>InspectionSchema</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-map-.3EExplanation"><div class="inner"><span>map-&gt;Explanation</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-strict-map-.3EExplanation"><div class="inner"><span>strict-map-&gt;Explanation</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">clara.tools.inspect</h1><div class="doc"><div class="markdown"><p>Tooling to inspect a rule session. The two major methods here are:</p>
<ul>
  <li>inspect, which returns a data structure describing the session that can be used by tooling.</li>
  <li>explain-activations, which uses inspect and prints a human-readable description covering  why each rule activation or query match occurred.</li>
</ul></div></div><div class="public anchor" id="var--.3EExplanation"><h3>-&gt;Explanation</h3><div class="usage"><code>(-&gt;Explanation matches bindings)</code></div><div class="doc"><div class="markdown"><p>Positional factory function for class clara.tools.inspect.Explanation.</p></div></div></div><div class="public anchor" id="var-explain-activations"><h3>explain-activations</h3><div class="usage"><code>(explain-activations session &amp; {:keys [rule-filter-fn], :as options})</code></div><div class="doc"><div class="markdown"><p>Prints a human-friend explanation of why rules and queries matched in the given session. A caller my optionally pass a :rule-filter-fn, which is a predicate</p>
<p>(clara.tools.inspect/explain-activations session  :rule-filter-fn (fn [rule] (re-find my-rule-regex (:name rule))))</p></div></div></div><div class="public anchor" id="var-inspect"><h3>inspect</h3><div class="usage"><code>(inspect session)</code></div><div class="doc"><div class="markdown"><p>Inputs: [session]</p>
<p>Returns a representation of the given rule session useful to understand the state of the underlying rules.</p>
<p>The returned structure includes the following keys:</p>
<ul>
  <li>:rule-matches &ndash; a map of rule structures to their matching explanations.</li>
  <li>:query-matches &ndash; a map of query structures to their matching explanations.</li>
  <li>:condition-matches &ndash; a map of conditions pulled from each rule to facts they match.</li>
  <li>:insertions &ndash; a map of rules to a sequence of {:explanation E, :fact F} records  to allow inspection of why a given fact was inserted.</li>
</ul>
<p>Users may inspect the entire structure for troubleshooting or explore it for specific cases. For instance, the following code snippet could look at all matches for some example rule:</p>
<p>(defrule example-rule &hellip; )</p>
<p>&hellip;</p>
<p>(get-in (inspect example-session) [:rule-matches example-rule])</p>
<p>&hellip;</p>
<p>The above segment will return matches for the rule in question.</p></div></div></div><div class="public anchor" id="var-InspectionSchema"><h3>InspectionSchema</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-map-.3EExplanation"><h3>map-&gt;Explanation</h3><div class="usage"><code>(map-&gt;Explanation m10109)</code></div><div class="doc"><div class="markdown"><p>Factory function for class Explanation, taking a map of keywords to field values, but not much slower than -&gt;x like the clojure.core version. (performance is fixed in Clojure 1.7, so this should eventually be removed.)</p></div></div></div><div class="public anchor" id="var-strict-map-.3EExplanation"><h3>strict-map-&gt;Explanation</h3><div class="usage"><code>(strict-map-&gt;Explanation m10110 &amp; [drop-extra-keys?__2257__auto__])</code></div><div class="doc"><div class="markdown"><p>Factory function for class Explanation, taking a map of keywords to field values. All keys are required, and no extra keys are allowed. Even faster than map-&gt;</p></div></div></div></div></body></html>