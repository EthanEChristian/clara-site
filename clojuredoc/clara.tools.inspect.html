<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>clara.tools.inspect documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Clara-rules 0.9.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clara</span></div></div></li><li class="depth-2 branch"><a href="clara.macros.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>macros</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rules</span></div></div></li><li class="depth-3 branch"><a href="clara.rules.dsl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dsl</span></div></a></li><li class="depth-3 branch"><a href="clara.rules.durability.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>durability</span></div></a></li><li class="depth-3"><a href="clara.rules.schema.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>tools</span></div></div></li><li class="depth-3 branch current"><a href="clara.tools.inspect.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inspect</span></div></a></li><li class="depth-3 branch"><a href="clara.tools.tracing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tracing</span></div></a></li><li class="depth-3"><a href="clara.tools.viz.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>viz</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clara.tools.inspect.html#var--.3EExplanation"><div class="inner"><span>-&gt;Explanation</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-explain-activations"><div class="inner"><span>explain-activations</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-inspect"><div class="inner"><span>inspect</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-InspectionSchema"><div class="inner"><span>InspectionSchema</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-map-.3EExplanation"><div class="inner"><span>map-&gt;Explanation</span></div></a></li><li class="depth-1"><a href="clara.tools.inspect.html#var-strict-map-.3EExplanation"><div class="inner"><span>strict-map-&gt;Explanation</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">clara.tools.inspect</h2><div class="doc"><pre class="plaintext">Tooling to inspect a rule session. The two major methods here are:

* inspect, which returns a data structure describing the session that can be used by tooling.
* explain-activations, which uses inspect and prints a human-readable description covering
  why each rule activation or query match occurred.</pre></div><div class="public anchor" id="var--.3EExplanation"><h3>-&gt;Explanation</h3><div class="usage"><code>(-&gt;Explanation matches bindings)</code></div><div class="doc"><pre class="plaintext">Positional factory function for class clara.tools.inspect.Explanation.
</pre></div></div><div class="public anchor" id="var-explain-activations"><h3>explain-activations</h3><div class="usage"><code>(explain-activations session &amp; {:keys [rule-filter-fn], :as options})</code></div><div class="doc"><pre class="plaintext">Prints a human-friend explanation of why rules and queries matched in the given session.
A caller my optionally pass a :rule-filter-fn, which is a predicate

(clara.tools.inspect/explain-activations session
       :rule-filter-fn (fn [rule] (re-find my-rule-regex (:name rule))))</pre></div></div><div class="public anchor" id="var-inspect"><h3>inspect</h3><div class="usage"><code>(inspect session)</code></div><div class="doc"><pre class="plaintext">Inputs: [session]

Returns a representation of the given rule session useful to understand the
state of the underlying rules.

The returned structure includes the following keys:

* :rule-matches -- a map of rule structures to their matching explanations.
* :query-matches -- a map of query structures to their matching explanations.
* :condition-matches -- a map of conditions pulled from each rule to facts they match.
* :insertions -- a map of rules to a sequence of {:explanation E, :fact F} records
  to allow inspection of why a given fact was inserted.

Users may inspect the entire structure for troubleshooting or explore it
for specific cases. For instance, the following code snippet could look
at all matches for some example rule:

(defrule example-rule ... )

...

(get-in (inspect example-session) [:rule-matches example-rule])

...

The above segment will return matches for the rule in question.</pre></div></div><div class="public anchor" id="var-InspectionSchema"><h3>InspectionSchema</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div></div><div class="public anchor" id="var-map-.3EExplanation"><h3>map-&gt;Explanation</h3><div class="usage"><code>(map-&gt;Explanation m9124)</code></div><div class="doc"><pre class="plaintext">Factory function for class Explanation, taking a map of keywords to field values, but not 400x slower than -&gt;x like the clojure.core version
</pre></div></div><div class="public anchor" id="var-strict-map-.3EExplanation"><h3>strict-map-&gt;Explanation</h3><div class="usage"><code>(strict-map-&gt;Explanation m9125 &amp; [drop-extra-keys?__1780__auto__])</code></div><div class="doc"><pre class="plaintext">Factory function for class Explanation, taking a map of keywords to field values.  All keys are required, and no extra keys are allowed.  Even faster than map-&gt;
</pre></div></div></div></body></html>